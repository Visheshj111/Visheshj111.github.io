<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexus - The Future of Your College</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://unpkg.com/ogl@0.0.122/dist/ogl.umd.js"></script>
    <style>
        :root {
            --glow-color: 132, 0, 255;
            --border-color: #392e4e;
            --background-dark: #060010;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0A0A0A;
            color: #E2E8F0;
        }
        .hero-gradient {
            background: radial-gradient(ellipse 80% 50% at 50% -20%, rgba(120, 119, 198, 0.3), rgba(255, 255, 255, 0));
        }
        .glow-effect {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            filter: blur(150px);
            background: radial-gradient(circle, rgba(99, 102, 241, 0.3) 0%, rgba(99, 102, 241, 0) 60%);
        }
        .scroll-animation {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .scroll-animation.visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Magic Bento Grid Styles */
        .card-grid {
          display: grid;
          gap: 1rem;
          padding: 1rem;
          max-width: 1200px;
          margin: 0 auto;
        }
        .card {
          display: flex;
          flex-direction: column;
          justify-content: space-between;
          position: relative;
          aspect-ratio: 4/3;
          padding: 1.25em;
          border-radius: 20px;
          border: 1px solid var(--border-color);
          background: var(--background-dark);
          font-weight: 300;
          overflow: hidden;
          transition: all 0.3s ease;
          --glow-x: 50%;
          --glow-y: 50%;
          --glow-intensity: 0;
          --glow-radius: 300px;
          color: #fff;
        }
        .card:hover {
          transform: translateY(-5px);
          box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }
        .card__header, .card__content {
          position: relative;
          z-index: 10;
        }
        .card__label {
          font-size: 1rem;
          color: #a7a7a7;
        }
        .card__title {
          font-weight: 600;
          font-size: 1.5rem;
          margin: 0.25em 0;
        }
        .card__description {
          font-size: 1rem;
          line-height: 1.4;
          opacity: 0.9;
        }
        .card--border-glow::after {
          content: '';
          position: absolute;
          inset: 0;
          padding: 2px;
          background: radial-gradient(var(--glow-radius) circle at var(--glow-x) var(--glow-y),
              rgba(var(--glow-color), calc(var(--glow-intensity) * 0.8)) 0%,
              rgba(var(--glow-color), calc(var(--glow-intensity) * 0.4)) 30%,
              transparent 60%);
          border-radius: inherit;
          mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
          mask-composite: subtract;
          -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
          -webkit-mask-composite: xor;
          pointer-events: none;
          transition: opacity 0.3s ease;
          z-index: 1;
        }
        .particle-container {
          position: relative;
          overflow: hidden;
        }
        .global-spotlight {
          position: fixed;
          width: 800px;
          height: 800px;
          border-radius: 50%;
          pointer-events: none;
          background: radial-gradient(circle,
            rgba(var(--glow-color), 0.15) 0%,
            rgba(var(--glow-color), 0.08) 15%,
            rgba(var(--glow-color), 0.04) 25%,
            transparent 70%
          );
          z-index: 200;
          opacity: 0;
          transform: translate(-50%, -50%);
          mix-blend-mode: screen;
          will-change: transform, opacity;
        }
        .bento-section {
          position: relative;
          user-select: none;
        }
        
        /* Light Rays Styles */
        .light-rays-container {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }
        
        /* Dock Styles */
        .dock-container {
            position: fixed;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            background-color: rgba(6, 0, 16, 0.5);
            border: 1px solid #222;
            padding: 0.75rem;
            border-radius: 1.25rem;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }
        .dock-item {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background-color: #110f1a;
            border: 1px solid #333;
            cursor: pointer;
            outline: none;
            color: #a7a7a7;
            transition: color 0.2s;
        }
        .dock-item:hover {
            color: #fff;
        }
        .dock-label {
            position: absolute;
            left: calc(100% + 15px);
            top: 50%;
            transform: translateY(-50%);
            width: max-content;
            white-space: nowrap;
            border-radius: 0.375rem;
            border: 1px solid #222;
            background-color: #060010;
            padding: 0.25rem 0.75rem;
            font-size: 0.875rem;
            color: #fff;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s ease, transform 0.2s ease;
        }
        .dock-item:hover .dock-label {
            opacity: 1;
            transform: translateY(-50%) translateX(5px);
        }
        
        #loading-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            font-size: 1.25rem;
        }

        @media (min-width: 600px) {
          .card-grid {
            grid-template-columns: repeat(2, 1fr);
          }
        }
        @media (min-width: 1024px) {
          .card-grid {
            grid-template-columns: repeat(4, 1fr);
          }
          .card:nth-child(1) { grid-column: span 2; grid-row: span 2; }
          .card:nth-child(4) { grid-column: span 2; }
        }
    </style>
</head>
<body class="antialiased opacity-0 transition-opacity duration-500">

    <div id="loading-indicator">
        <p>Loading...</p>
    </div>

    <!-- Dock Navigation -->
    <div id="dock-container" class="dock-container">
        <!-- Dock items will be injected by JavaScript -->
    </div>

    <main>
        <!-- Hero Section -->
        <section id="home" class="relative pt-48 pb-32 text-center hero-gradient overflow-hidden">
            <div id="light-rays-container" class="light-rays-container"></div>
            <div class="container mx-auto px-4 relative z-10">
                <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-4xl h-64" style="background: radial-gradient(ellipse at center, rgba(99, 102, 241, 0.2) 0%, rgba(99, 102, 241, 0) 70%); z-index: -1;"></div>
                <h1 class="text-5xl md:text-7xl font-extrabold text-transparent bg-clip-text bg-gradient-to-b from-white to-slate-400 leading-tight md:leading-snug mb-6">
                    The Operating System for Your University
                </h1>
                <p class="max-w-3xl mx-auto text-lg md:text-xl text-slate-400 mb-10">
                    Nexus integrates your entire campus into one seamless, intelligent platform. From academics to social life, we empower students and faculty like never before.
                </p>
                <div id="hero-cta-buttons" class="flex justify-center items-center space-x-4">
                     <a href="./login.html" class="bg-indigo-500 text-white font-semibold px-8 py-4 rounded-lg hover:bg-indigo-600 transition-all duration-300 shadow-lg shadow-indigo-500/20">Login / Sign Up</a>
                </div>
                <div id="user-info" class="hidden text-center mt-8">
                    <p class="text-slate-300">Welcome, <span id="user-email" class="font-bold"></span></p>
                    <button id="logout-button" class="mt-4 bg-red-500/80 text-white font-semibold px-6 py-2 rounded-lg hover:bg-red-600 transition-all duration-300">Logout</button>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section id="features" class="py-24 bento-section">
            <div class="container mx-auto px-4">
                <div class="text-center mb-16 scroll-animation">
                    <h2 class="text-4xl font-bold text-white mb-4">A Unified Campus Experience</h2>
                    <p class="text-slate-400 max-w-2xl mx-auto">Everything your institution needs, connected in one place. Intelligent, intuitive, and built for the future of education.</p>
                </div>
                <div class="card-grid" id="magic-bento-grid">
                    <!-- Cards will be injected by JavaScript -->
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-[#111111] border-t border-slate-800/50">
        <div class="container mx-auto px-4 py-16">
            <div class="grid md:grid-cols-3 gap-8">
                <div class="lg:col-span-1 mb-8 md:mb-0">
                     <a href="#" class="flex items-center space-x-2 mb-4">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="text-indigo-400">
                            <path d="M12 2L2 7V17L12 22L22 17V7L12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M2 7L12 12L22 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12 22V12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <span class="text-xl font-bold text-slate-200">Nexus</span>
                    </a>
                    <p class="text-slate-400 max-w-xs">The intelligent operating system for the modern university.</p>
                </div>
                <div>
                    <h4 class="font-bold text-white mb-4">Product</h4>
                    <ul class="space-y-3">
                        <li><a href="#features" class="text-slate-400 hover:text-indigo-400 transition">Features</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold text-white mb-4">Company</h4>
                    <ul class="space-y-3">
                        <li><a href="./aboutme.html" class="text-slate-400 hover:text-indigo-400 transition">About Me</a></li>
                        <li><a href="./aboutme.html" class="text-slate-400 hover:text-indigo-400 transition">Contact</a></li>
                    </ul>
                </div>
            </div>
            <div class="mt-16 pt-8 border-t border-slate-800/50 flex flex-col sm:flex-row justify-between items-center">
                <p class="text-slate-500 text-sm mb-4 sm:mb-0">&copy; 2025 Nexus Technologies Inc. All rights reserved.</p>
                <div class="flex space-x-5">
                    <a href="https://www.linkedin.com/in/vishesh-jangid3126/" target="_blank" rel="noopener noreferrer" class="text-slate-500 hover:text-indigo-400 transition"><i data-lucide="linkedin"></i></a>
                    <a href="https://github.com/Visheshj111" target="_blank" rel="noopener noreferrer" class="text-slate-500 hover:text-indigo-400 transition"><i data-lucide="github"></i></a>
                </div>
            </div>
        </div>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyD5PutZn5DYeuMcs9Z2AbflaYGxUpD-XFw",
            authDomain: "placement-cell-7b2ec.firebaseapp.com",
            projectId: "placement-cell-7b2ec",
            storageBucket: "placement-cell-7b2ec.appspot.com",
            messagingSenderId: "17277112372",
            appId: "1:17277112372:web:a9a8f3513633c3c3243a61"
        };
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        const loadingIndicator = document.getElementById('loading-indicator');
        const body = document.querySelector('body');
        const heroCtaButtons = document.getElementById('hero-cta-buttons');
        const userInfo = document.getElementById('user-info');
        const userEmailSpan = document.getElementById('user-email');
        const logoutButton = document.getElementById('logout-button');

        const unsubscribe = onAuthStateChanged(auth, (user) => {
            loadingIndicator.style.display = 'none';
            body.classList.remove('opacity-0');

            if (user) {
                heroCtaButtons.classList.add('hidden');
                userInfo.classList.remove('hidden');
                userEmailSpan.textContent = user.email;
            } else {
                heroCtaButtons.classList.remove('hidden');
                userInfo.classList.add('hidden');
            }
        });

        logoutButton.addEventListener('click', () => {
            signOut(auth).catch((error) => {
                console.error('Sign out error', error);
            });
        });


        // Initialize Lucide icons
        lucide.createIcons();

        // Scroll animations
        const scrollAnimations = document.querySelectorAll('.scroll-animation');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                }
            });
        }, {
            threshold: 0.1
        });
        scrollAnimations.forEach(el => {
            observer.observe(el);
        });

        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });

        // --- Dock Navigation Logic ---
        document.addEventListener('DOMContentLoaded', () => {
            const dockContainer = document.getElementById('dock-container');
            const items = [
                { href: '#home', icon: 'home', label: 'Home' },
                { href: '#features', icon: 'layout-grid', label: 'Features' },
                { href: './aboutme.html', icon: 'user', label: 'About Me' },
                { href: './aboutme.html', icon: 'mail', label: 'Contact' }
            ];
            
            const baseItemSize = 50;
            const magnification = 70;
            const distance = 150;

            items.forEach(item => {
                const dockItem = document.createElement('a');
                dockItem.href = item.href;
                dockItem.className = 'dock-item';
                dockItem.style.width = `${baseItemSize}px`;
                dockItem.style.height = `${baseItemSize}px`;
                
                dockItem.innerHTML = `
                    <i data-lucide="${item.icon}" class="w-6 h-6"></i>
                    <span class="dock-label">${item.label}</span>
                `;
                dockContainer.appendChild(dockItem);
            });
            lucide.createIcons();

            const dockItems = document.querySelectorAll('.dock-item');

            dockContainer.addEventListener('mousemove', (e) => {
                const mouseY = e.clientY;
                
                dockItems.forEach(item => {
                    const rect = item.getBoundingClientRect();
                    const itemCenterY = rect.top + rect.height / 2;
                    const mouseDistance = Math.abs(mouseY - itemCenterY);
                    
                    let newSize = baseItemSize;
                    if (mouseDistance < distance) {
                        const scale = 1 + (1 - mouseDistance / distance) * ((magnification - baseItemSize) / baseItemSize);
                        newSize = baseItemSize * scale;
                    }
                    
                    gsap.to(item, { width: newSize, height: newSize, duration: 0.2, ease: 'power2.out' });
                });
            });

            dockContainer.addEventListener('mouseleave', () => {
                gsap.to('.dock-item', { width: baseItemSize, height: baseItemSize, duration: 0.4, ease: 'power2.out' });
            });
        });

        // --- Magic Bento Grid Logic ---
        document.addEventListener('DOMContentLoaded', () => {
            const cardData = [
              { href: "./sheets.html", title: "Access All Sheets", description: "A single place to access all your documents, spreadsheets, and presentations.", label: "Sheets" },
              { href: "./notices.html", title: "All Notices", description: "View all official placement cell announcements and updates.", label: "Notices" },
              { href: "./noticegenerator.html", title: "Notice Generator", description: "Create standardized placement notices quickly and easily.", label: "Tools" },
              { href: "#", title: "Connected Community", description: "Dynamic student directories, event calendars, and club management tools.", label: "Community" },
              { href: "#", title: "Career Development", description: "Integrated job boards, alumni networking, and internship matching.", label: "Careers" },
              { href: "#", title: "Secure & Reliable", description: "State-of-the-art security protocols to protect student data.", label: "Security" },
            ];

            const grid = document.getElementById('magic-bento-grid');
            if (!grid) return;

            cardData.forEach(data => {
                const cardWrapper = document.createElement('a');
                cardWrapper.href = data.href;
                cardWrapper.className = 'card particle-container card--border-glow';
                
                cardWrapper.innerHTML = `
                    <div class="card__header">
                      <div class="card__label">${data.label}</div>
                    </div>
                    <div class="card__content">
                      <h2 class="card__title">${data.title}</h2>
                      <p class="card__description">${data.description}</p>
                    </div>
                `;
                grid.appendChild(cardWrapper);
            });

            const spotlight = document.createElement('div');
            spotlight.className = 'global-spotlight';
            document.body.appendChild(spotlight);

            const cards = document.querySelectorAll('.card');
            const spotlightRadius = 300;
            const glowColor = "132, 0, 255";

            const updateCardGlow = (card, mouseX, mouseY, glow, radius) => {
                const rect = card.getBoundingClientRect();
                const relativeX = ((mouseX - rect.left) / rect.width) * 100;
                const relativeY = ((mouseY - rect.top) / rect.height) * 100;
                card.style.setProperty("--glow-x", `${relativeX}%`);
                card.style.setProperty("--glow-y", `${relativeY}%`);
                card.style.setProperty("--glow-intensity", glow.toString());
                card.style.setProperty("--glow-radius", `${radius}px`);
                card.style.setProperty("--glow-color", glowColor);
            };

            const handleMouseMove = (e) => {
                const { proximity, fadeDistance } = { proximity: spotlightRadius * 0.5, fadeDistance: spotlightRadius * 0.75 };
                let minDistance = Infinity;

                cards.forEach(card => {
                    const rect = card.getBoundingClientRect();
                    const centerX = rect.left + rect.width / 2;
                    const centerY = rect.top + rect.height / 2;
                    const distance = Math.hypot(e.clientX - centerX, e.clientY - centerY) - Math.max(rect.width, rect.height) / 2;
                    const effectiveDistance = Math.max(0, distance);
                    minDistance = Math.min(minDistance, effectiveDistance);
                    
                    let glowIntensity = 0;
                    if (effectiveDistance <= proximity) glowIntensity = 1;
                    else if (effectiveDistance <= fadeDistance) glowIntensity = (fadeDistance - effectiveDistance) / (fadeDistance - proximity);
                    
                    updateCardGlow(card, e.clientX, e.clientY, glowIntensity, spotlightRadius);
                });

                gsap.to(spotlight, { left: e.clientX, top: e.clientY, duration: 0.1, ease: "power2.out" });

                const targetOpacity = minDistance <= proximity ? 0.8 : minDistance <= fadeDistance ? ((fadeDistance - minDistance) / (fadeDistance - proximity)) * 0.8 : 0;
                gsap.to(spotlight, { opacity: targetOpacity, duration: targetOpacity > 0 ? 0.2 : 0.5, ease: "power2.out" });
            };
            
            const handleMouseLeave = () => {
                 cards.forEach(card => card.style.setProperty("--glow-intensity", "0"));
                 gsap.to(spotlight, { opacity: 0, duration: 0.3, ease: "power2.out" });
            };

            const bentoSection = document.querySelector('.bento-section');
            bentoSection.addEventListener('mousemove', handleMouseMove);
            bentoSection.addEventListener('mouseleave', handleMouseLeave);
        });
        
        // --- Light Rays Logic ---
        document.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('light-rays-container');
            if (!container) return;

            const { Renderer, Program, Triangle, Mesh } = ogl;

            const settings = {
                raysOrigin: "top-center",
                raysColor: "#00ffff",
                raysSpeed: 1.5,
                lightSpread: 0.8,
                rayLength: 1.2,
                followMouse: true,
                mouseInfluence: 0.1,
                noiseAmount: 0.1,
                distortion: 0.05,
            };

            const hexToRgb = (hex) => {
              const m = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
              return m ? [parseInt(m[1], 16) / 255, parseInt(m[2], 16) / 255, parseInt(m[3], 16) / 255] : [1, 1, 1];
            };

            const getAnchorAndDir = (origin, w, h) => {
              const outside = 0.2;
              switch (origin) {
                case "top-left": return { anchor: [0, -outside * h], dir: [0, 1] };
                case "top-right": return { anchor: [w, -outside * h], dir: [0, 1] };
                case "left": return { anchor: [-outside * w, 0.5 * h], dir: [1, 0] };
                case "right": return { anchor: [(1 + outside) * w, 0.5 * h], dir: [-1, 0] };
                case "bottom-left": return { anchor: [0, (1 + outside) * h], dir: [0, -1] };
                case "bottom-center": return { anchor: [0.5 * w, (1 + outside) * h], dir: [0, -1] };
                case "bottom-right": return { anchor: [w, (1 + outside) * h], dir: [0, -1] };
                default: return { anchor: [0.5 * w, -outside * h], dir: [0, 1] };
              }
            };

            const renderer = new Renderer({ dpr: Math.min(window.devicePixelRatio, 2), alpha: true });
            const gl = renderer.gl;
            container.appendChild(gl.canvas);
            
            const vert = `attribute vec2 position;varying vec2 vUv;void main() { vUv = position * 0.5 + 0.5; gl_Position = vec4(position, 0.0, 1.0);}`;
            const frag = `precision highp float;uniform float iTime;uniform vec2 iResolution;uniform vec2 rayPos;uniform vec2 rayDir;uniform vec3 raysColor;uniform float raysSpeed;uniform float lightSpread;uniform float rayLength;uniform vec2 mousePos;uniform float mouseInfluence;uniform float noiseAmount;uniform float distortion;varying vec2 vUv;float noise(vec2 st) { return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453123); }float rayStrength(vec2 raySource, vec2 rayRefDirection, vec2 coord, float seedA, float seedB, float speed) { vec2 sourceToCoord = coord - raySource; vec2 dirNorm = normalize(sourceToCoord); float cosAngle = dot(dirNorm, rayRefDirection); float distortedAngle = cosAngle + distortion * sin(iTime * 2.0 + length(sourceToCoord) * 0.01) * 0.2; float spreadFactor = pow(max(distortedAngle, 0.0), 1.0 / max(lightSpread, 0.001)); float distance = length(sourceToCoord); float maxDistance = iResolution.x * rayLength; float lengthFalloff = clamp((maxDistance - distance) / maxDistance, 0.0, 1.0); float pulse = (0.8 + 0.2 * sin(iTime * speed * 3.0)); float baseStrength = clamp((0.45 + 0.15 * sin(distortedAngle * seedA + iTime * speed)) + (0.3 + 0.2 * cos(-distortedAngle * seedB + iTime * speed)), 0.0, 1.0); return baseStrength * lengthFalloff * spreadFactor * pulse; }void main() { vec2 coord = gl_FragCoord.xy; vec2 finalRayDir = rayDir; if (mouseInfluence > 0.0) { vec2 mouseScreenPos = mousePos * iResolution.xy; vec2 mouseDirection = normalize(mouseScreenPos - rayPos); finalRayDir = normalize(mix(rayDir, mouseDirection, mouseInfluence)); } vec4 rays1 = vec4(1.0) * rayStrength(rayPos, finalRayDir, coord, 36.2214, 21.11349, 1.5 * raysSpeed); vec4 rays2 = vec4(1.0) * rayStrength(rayPos, finalRayDir, coord, 22.3991, 18.0234, 1.1 * raysSpeed); vec4 color = rays1 * 0.5 + rays2 * 0.4; if (noiseAmount > 0.0) { float n = noise(coord * 0.01 + iTime * 0.1); color.rgb *= (1.0 - noiseAmount + noiseAmount * n); } gl_FragColor = color * vec4(raysColor, 1.0);}`;

            const uniforms = {
                iTime: { value: 0 },
                iResolution: { value: [1, 1] },
                rayPos: { value: [0, 0] },
                rayDir: { value: [0, 1] },
                raysColor: { value: hexToRgb(settings.raysColor) },
                raysSpeed: { value: settings.raysSpeed },
                lightSpread: { value: settings.lightSpread },
                rayLength: { value: settings.rayLength },
                mousePos: { value: [0.5, 0.5] },
                mouseInfluence: { value: settings.mouseInfluence },
                noiseAmount: { value: settings.noiseAmount },
                distortion: { value: settings.distortion },
            };

            const program = new Program(gl, { vertex: vert, fragment: frag, uniforms });
            const mesh = new Mesh(gl, { geometry: new Triangle(gl), program });
            
            const mouse = { x: 0.5, y: 0.5 };
            const smoothMouse = { x: 0.5, y: 0.5 };

            function updatePlacement() {
                if (!container) return;
                renderer.dpr = Math.min(window.devicePixelRatio, 2);
                const { clientWidth: wCSS, clientHeight: hCSS } = container;
                renderer.setSize(wCSS, hCSS);
                const dpr = renderer.dpr;
                const w = wCSS * dpr;
                const h = hCSS * dpr;
                uniforms.iResolution.value = [w, h];
                const { anchor, dir } = getAnchorAndDir(settings.raysOrigin, w, h);
                uniforms.rayPos.value = anchor;
                uniforms.rayDir.value = dir;
            }

            window.addEventListener("resize", updatePlacement);
            updatePlacement();
            
            if (settings.followMouse) {
                window.addEventListener("mousemove", (e) => {
                    const rect = container.getBoundingClientRect();
                    mouse.x = (e.clientX - rect.left) / rect.width;
                    mouse.y = (e.clientY - rect.top) / rect.height;
                });
            }

            function loop(t) {
                requestAnimationFrame(loop);
                uniforms.iTime.value = t * 0.001;
                
                const smoothing = 0.92;
                smoothMouse.x = smoothMouse.x * smoothing + mouse.x * (1 - smoothing);
                smoothMouse.y = smoothMouse.y * smoothing + mouse.y * (1 - smoothing);
                uniforms.mousePos.value = [smoothMouse.x, smoothMouse.y];

                renderer.render({ scene: mesh });
            }
            requestAnimationFrame(loop);
        });

    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vishesh Jangid - Developer Portfolio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display-swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    <style>
        :root {
            --bg-light: #f9fafb;
            --text-light: #1f2937;
            --card-light: #ffffff;
            --border-light: #e5e7eb;
            --primary-light: #4338ca;
            --primary-hover-light: #3730a3;
            --subtle-light: #f3f4f6;

            --bg-dark: #111827;
            --text-dark: #d1d5db;
            --card-dark: #1f2937;
            --border-dark: #374151;
            --primary-dark: #818cf8;
            --primary-hover-dark: #6366f1;
            --subtle-dark: #1f2937;
        }

        .dark-mode {
            --bg-light: #111827;
            --text-light: #d1d5db;
            --card-light: #1f2937;
            --border-light: #374151;
            --primary-light: #818cf8;
            --primary-hover-light: #6366f1;
            --subtle-light: #1f2937;

            --bg-dark: #f9fafb;
            --text-dark: #1f2937;
            --card-dark: #ffffff;
            --border-dark: #e5e7eb;
            --primary-dark: #4338ca;
            --primary-hover-dark: #3730a3;
            --subtle-dark: #f3f4f6;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-light);
            color: var(--text-light);
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .section-card {
            background-color: var(--card-light);
            border: 1px solid var(--border-light);
        }
        
        .section-card-subtle {
             background-color: var(--subtle-light);
        }

        .btn-primary {
            background-color: var(--primary-light);
            color: #fff;
            transition: background-color 0.2s ease, transform 0.2s ease;
        }

        .btn-primary:hover {
            background-color: var(--primary-hover-light);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background-color: transparent;
            color: var(--primary-light);
            border: 1px solid var(--primary-light);
            transition: all 0.2s ease;
        }

        .btn-secondary:hover {
            background-color: var(--primary-light);
            color: #fff;
            transform: translateY(-2px);
        }

        .animated-section {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }

        .animated-section.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .gradient-text {
            background: linear-gradient(to right, var(--primary-light), #9333ea);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .project-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .dark-mode .project-card:hover {
             box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.1);
        }
        
        .nav-link {
            position: relative;
            color: var(--text-light);
            transition: color 0.3s;
        }
        .nav-link:hover {
            color: var(--primary-light);
        }
        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -6px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--primary-light);
            transition: width 0.3s ease;
        }
        .nav-link:hover::after, .nav-link.active::after {
            width: 60%;
        }
        
        .tag {
            background-color: var(--primary-light);
            color: #fff;
            opacity: 0.8;
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
        }

        #game-overlay {
            background-color: rgba(17, 24, 39, 0.9);
        }
        #game-canvas {
            background-color: #000;
            border: 2px solid var(--primary-dark);
            border-radius: 0.5rem;
        }
        kbd {
            font-family: monospace;
            background-color: var(--subtle-light);
            border: 1px solid var(--border-light);
            border-bottom-width: 3px;
            border-radius: 4px;
            padding: 3px 6px;
            font-size: 0.9em;
        }
        .dark-mode kbd {
            background-color: #374151;
            border-color: #4b5563;
        }

        /* Hero Animation */
        .hero-animation-container {
            position: relative;
            width: 100%;
            height: 400px;
        }

        .hero-shape {
            position: absolute;
            border-radius: 1rem;
            background: var(--subtle-light);
            border: 1px solid var(--border-light);
            will-change: transform;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }

        .shape1 {
            width: 150px;
            height: 150px;
            top: 20%;
            left: 10%;
            animation: float 10s ease-in-out infinite;
            background-color: var(--primary-light);
            opacity: 0.3;
        }

        .shape2 {
            width: 80px;
            height: 80px;
            top: 10%;
            left: 60%;
            animation: float 12s ease-in-out infinite 2s;
        }

        .shape3 {
            width: 120px;
            height: 120px;
            top: 60%;
            left: 50%;
            animation: float 9s ease-in-out infinite 1s;
        }

        .shape4 {
            width: 60px;
            height: 60px;
            top: 75%;
            left: 15%;
            animation: float 14s ease-in-out infinite 3s;
            background-color: var(--primary-light);
            opacity: 0.5;
        }

    </style>
</head>

<body class="antialiased">

    <header id="header" class="fixed top-0 left-0 right-0 z-50 transition-all duration-300">
        <nav class="container mx-auto px-8 py-4 flex justify-between items-center">
            <a href="#home" class="text-2xl font-bold gradient-text">VJ</a>
            <div class="hidden md:flex items-center space-x-8">
                <a href="#about" class="nav-link">About</a>
                <a href="#projects" class="nav-link">Projects</a>
                <a href="#experience" class="nav-link">Experience</a>
                <a href="#contact" class="nav-link">Contact</a>
                 <button id="theme-toggle" class="ml-4 p-2 rounded-full focus:outline-none hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
                    <i data-lucide="sun" id="theme-icon-light"></i>
                    <i data-lucide="moon" id="theme-icon-dark" class="hidden"></i>
                </button>
            </div>

            <div class="flex items-center md:hidden">
                <button id="theme-toggle-mobile" class="p-2 rounded-full focus:outline-none">
                    <i data-lucide="sun" id="theme-icon-light-mobile"></i>
                    <i data-lucide="moon" id="theme-icon-dark-mobile" class="hidden"></i>
                </button>
                <button id="mobile-menu-button" class="ml-2 p-2 rounded-md">
                    <i data-lucide="menu"></i>
                </button>
            </div>
        </nav>
        <div id="mobile-menu" class="hidden md:hidden section-card-subtle">
            <a href="#about" class="block py-2 px-6 text-sm">About</a>
            <a href="#projects" class="block py-2 px-6 text-sm">Projects</a>
            <a href="#experience" class="block py-2 px-6 text-sm">Experience</a>
            <a href="#contact" class="block py-2 px-6 text-sm">Contact</a>
        </div>
    </header>

    <main class="container mx-auto px-8 pt-24">

        <section id="home" class="min-h-screen flex items-center animated-section">
            <div class="grid md:grid-cols-2 items-center gap-16 w-full">
                <div class="max-w-3xl">
                    <h1 class="text-5xl md:text-7xl font-extrabold" style="color: var(--text-light);">Vishesh Jangid</h1>
                    <h2 class="text-2xl md:text-3xl font-semibold mt-4 gradient-text">Developer & Problem Solver</h2>
                    <p class="mt-6 text-lg max-w-2xl" style="color: var(--text-light); opacity: 0.8;">
                        BCA student from ICCS, Pune, with a passion for building intuitive web applications, engaging games, and data-driven solutions. Currently seeking internship opportunities in the technical field.
                    </p>
                    <div class="mt-8 flex flex-wrap items-center gap-4">
                        <a href="#contact" class="btn-primary px-6 py-3 rounded-md font-semibold">Get in Touch</a>
                        <button id="play-game-btn" class="btn-secondary px-6 py-3 rounded-md font-semibold flex items-center gap-2">
                            <i data-lucide="gamepad-2" class="w-5 h-5"></i>
                            Play a Game
                        </button>
                        <div class="flex items-center space-x-2">
                            <a href="https://www.linkedin.com/in/vishesh-jangid3126/" target="_blank" rel="noopener noreferrer" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
                                <i data-lucide="linkedin" class="w-6 h-6"></i>
                            </a>
                            <a href="https://github.com/Visheshj111" target="_blank" rel="noopener noreferrer" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
                                <i data-lucide="github" class="w-6 h-6"></i>
                            </a>
                        </div>
                    </div>
                </div>
                 <div class="hidden md:block">
                    <div class="hero-animation-container">
                        <div class="hero-shape shape1"></div>
                        <div class="hero-shape shape2"></div>
                        <div class="hero-shape shape3"></div>
                        <div class="hero-shape shape4"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Other sections remain unchanged -->
        <section id="about" class="py-24 animated-section">
            <div class="text-center mb-16">
               <h2 class="text-4xl font-bold gradient-text">About Me</h2>
           </div>
           <div class="grid grid-cols-1 md:grid-cols-5 gap-12 items-center">
               <div class="md:col-span-3">
                   <p class="text-lg leading-relaxed opacity-90">
                       Hello! I’m Vishesh, a self-taught developer who loves bringing ideas to life. My journey started with a fascination for video games, which evolved into a broader passion for software development. I enjoy the entire process, from conceptualizing and designing to coding and deploying.
                       <br/><br/>
                       I thrive on challenges and am constantly exploring new technologies to expand my skillset. Whether it's building a full-stack web application, designing game mechanics, or analyzing data, I'm driven by a desire to create things that are both functional and enjoyable to use.
                   </p>
               </div>
               <div class="md:col-span-2 section-card p-6 rounded-xl">
                   <h3 class="text-xl font-bold mb-4">Core Skills</h3>
                   <div class="flex flex-wrap gap-2">
                       <span class="tag">JavaScript</span><span class="tag">React</span><span class="tag">Node.js</span><span class="tag">Python</span><span class="tag">C++</span><span class="tag">Godot</span><span class="tag">Unreal</span><span class="tag">Firebase</span><span class="tag">MongoDB</span>
                   </div>
               </div>
           </div>
       </section>

       <section id="projects" class="py-24 animated-section">
           <div class="text-center mb-16">
               <h2 class="text-4xl font-bold gradient-text">Featured Projects</h2>
           </div>
           <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <a href="aptitude-test-app.rar" download="aptitude-test-app.rar" class="block section-card rounded-xl overflow-hidden shadow-md project-card transition-all duration-300">
                   <img src="https://placehold.co/600x400/1f2937/d1d5db?text=Assessment+App" alt="Assessment Website" class="w-full h-56 object-cover">
                   <div class="p-6">
                       <h3 class="text-xl font-bold mb-2">Assessment Website</h3>
                       <p class="text-sm opacity-80 mb-4">An online assessment platform. Click to download the project files.</p>
                       <div class="flex flex-wrap gap-2">
                           <span class="tag">MongoDB</span><span class="tag">JavaScript</span><span class="tag">Netlify</span><span class="tag">Render</span>
                       </div>
                   </div>
               </a>
               <div class="section-card rounded-xl overflow-hidden shadow-md project-card transition-all duration-300">
                   <img src="https://placehold.co/600x400/1f2937/d1d5db?text=Bottlenotes" alt="Bottlenotes" class="w-full h-56 object-cover">
                   <div class="p-6">
                       <h3 class="text-xl font-bold mb-2">Bottlenotes (Note-Taking App)</h3>
                       <p class="text-sm opacity-80 mb-4">A Notion-inspired app with a sleek glassmorphism UI and Firestore sync.</p>
                        <div class="flex flex-wrap gap-2">
                           <span class="tag">Firebase</span><span class="tag">React</span><span class="tag">Glassmorphism</span>
                       </div>
                   </div>
               </div>
                <div class="section-card rounded-xl overflow-hidden shadow-md project-card transition-all duration-300">
                   <img src="https://placehold.co/600x400/1f2937/d1d5db?text=Health+AI" alt="Health Analysis App" class="w-full h-56 object-cover">
                   <div class="p-6">
                       <h3 class="text-xl font-bold mb-2">Health Analysis App</h3>
                       <p class="text-sm opacity-80 mb-4">AI-powered health analysis using the ChatGPT API.</p>
                       <div class="flex flex-wrap gap-2">
                           <span class="tag">Builder.io</span><span class="tag">AI/ML</span><span class="tag">ChatGPT</span>
                       </div>
                   </div>
               </div>
                <div class="section-card rounded-xl overflow-hidden shadow-md project-card transition-all duration-300">
                   <img src="https://placehold.co/600x400/1f2937/d1d5db?text=Personal+OS" alt="Personal OS" class="w-full h-56 object-cover">
                   <div class="p-6">
                       <h3 class="text-xl font-bold mb-2">Personal Operating System (POS)</h3>
                       <p class="text-sm opacity-80 mb-4">A personal dashboard with notes, expenses, a focus timer, and more.</p>
                        <div class="flex flex-wrap gap-2">
                           <span class="tag">Web App</span><span class="tag">Productivity</span><span class="tag">JavaScript</span>
                       </div>
                   </div>
               </div>
           </div>
       </section>

       <section id="experience" class="py-24 animated-section">
           <div class="text-center mb-16">
                <h2 class="text-4xl font-bold gradient-text">Experience & Interests</h2>
           </div>
           <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 max-w-5xl mx-auto">
                <div class="section-card p-8 rounded-xl">
                   <div class="flex items-center gap-4 mb-4">
                       <i data-lucide="briefcase" class="w-8 h-8" style="color:var(--primary-light)"></i>
                       <h3 class="text-2xl font-bold">Experience</h3>
                   </div>
                   <h4 class="text-xl font-semibold">Placement Executive | Corporate Relations</h4>
                   <p class="text-sm opacity-70 mb-2">Feb 2024 - Present</p>
                   <p class="opacity-90">Acted as a key liaison between students and recruiters, honing my communication, organization, and teamwork skills in a fast-paced environment.</p>
               </div>
               <div class="section-card p-8 rounded-xl">
                   <div class="flex items-center gap-4 mb-4">
                       <i data-lucide="gamepad-2" class="w-8 h-8" style="color:var(--primary-light)"></i>
                       <h3 class="text-2xl font-bold">Interests</h3>
                   </div>
                    <ul class="space-y-2 list-disc list-inside opacity-90">
                       <li><strong>Gaming & Game Design:</strong> Passionate about immersive storytelling in games like The Last of Us and Assassin's Creed.</li>
                       <li><strong>Outdoor Adventures:</strong> Exploring new places through trekking and bike riding.</li>
                       <li><strong>Tech Exploration:</strong> Always curious about emerging technologies and their applications.</li>
                   </ul>
               </div>
           </div>
       </section>

       <section id="contact" class="py-24 text-center animated-section">
           <div class="section-card-subtle max-w-4xl mx-auto p-10 rounded-xl">
               <h2 class="text-4xl font-bold gradient-text">Let's Build Something Together</h2>
               <p class="mt-4 max-w-2xl mx-auto opacity-80">I'm excited to apply my skills to new challenges. If you have an opportunity or just want to connect, feel free to reach out.</p>
               <div class="mt-8">
                   <a href="mailto:vishesh3126jangid@gmail.com" class="btn-primary px-8 py-3 rounded-md font-semibold text-lg inline-block">Say Hello</a>
               </div>
           </div>
       </section>

    </main>

    <!-- Game Controls Modal -->
    <div id="game-controls-modal" class="fixed inset-0 z-50 flex-col items-center justify-center hidden" style="background-color: rgba(17, 24, 39, 0.9);">
        <div class="section-card p-8 rounded-xl max-w-md text-center shadow-2xl">
            <h2 class="text-3xl font-bold gradient-text mb-6">Game Controls</h2>
            <div class="text-left space-y-4 opacity-90 mx-auto inline-block">
                <p class="flex items-center justify-between"><span class="mr-4">Thrust Forward</span> <kbd>↑</kbd></p>
                <p class="flex items-center justify-between"><span class="mr-4">Rotate Ship</span> <span><kbd>←</kbd> / <kbd>→</kbd></span></p>
                <p class="flex items-center justify-between"><span class="mr-4">Shoot</span> <kbd>Spacebar</kbd></p>
                <p class="flex items-center justify-between"><span class="mr-4">Restart Game</span> <kbd>R</kbd></p>
                <p class="flex items-center justify-between"><span class="mr-4">Exit Game</span> <kbd>Esc</kbd></p>
            </div>
            <button id="start-game-btn" class="btn-primary mt-8 px-8 py-3 rounded-md font-semibold text-lg w-full">Start Game</button>
        </div>
    </div>

    <!-- Game Overlay -->
    <div id="game-overlay" class="fixed inset-0 z-50 flex-col items-center justify-center hidden">
        <div class="absolute top-4 right-4 text-white text-lg font-mono" id="game-score">SCORE: 0</div>
        <div id="game-message" class="hidden absolute text-white text-center">
            <h2 id="game-over-text" class="text-4xl font-bold">GAME OVER</h2>
            <p id="final-score-text" class="text-xl mt-2"></p>
            <p class="mt-4 text-lg">Press 'R' to Restart</p>
        </div>
        <button id="close-game-btn" class="absolute top-4 left-4 text-white p-2 rounded-full hover:bg-white/20 transition-colors">
            <i data-lucide="x" class="w-8 h-8"></i>
        </button>
        <canvas id="game-canvas"></canvas>
    </div>
    
    <footer class="text-center py-8 mt-16" style="border-top: 1px solid var(--border-light);">
        <div class="flex justify-center items-center space-x-6 mb-4">
             <a href="https://www.linkedin.com/in/vishesh-jangid3126/" target="_blank" rel="noopener noreferrer" class="hover:text-primary-light transition-colors"><i data-lucide="linkedin"></i></a>
             <a href="https://github.com/Visheshj111" target="_blank" rel="noopener noreferrer" class="hover:text-primary-light transition-colors"><i data-lucide="github"></i></a>
             <a href="https://buymeacoffee.com/visheshjangid" target="_blank" rel="noopener noreferrer" class="hover:text-primary-light transition-colors"><i data-lucide="coffee"></i></a>
        </div>
        <p class="opacity-70">&copy; 2024 Vishesh Jangid. All Rights Reserved.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize Lucide Icons
            lucide.createIcons();

            const themeToggle = document.getElementById('theme-toggle');
            const themeToggleMobile = document.getElementById('theme-toggle-mobile');
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            const header = document.getElementById('header');
            const sections = document.querySelectorAll('section');
            const navLinks = document.querySelectorAll('.nav-link');

            // --- Theme Toggling ---
            const applyTheme = (theme) => {
                const isDark = theme === 'dark';
                document.documentElement.classList.toggle('dark-mode', isDark);
                
                document.getElementById('theme-icon-light').classList.toggle('hidden', isDark);
                document.getElementById('theme-icon-dark').classList.toggle('hidden', !isDark);

                document.getElementById('theme-icon-light-mobile').classList.toggle('hidden', isDark);
                document.getElementById('theme-icon-dark-mobile').classList.toggle('hidden', !isDark);
            };

            const savedTheme = localStorage.getItem('theme') || 'dark';
            applyTheme(savedTheme);

            const toggleTheme = () => {
                const newTheme = document.documentElement.classList.contains('dark-mode') ? 'light' : 'dark';
                localStorage.setItem('theme', newTheme);
                applyTheme(newTheme);
            };
            
            themeToggle.addEventListener('click', toggleTheme);
            themeToggleMobile.addEventListener('click', toggleTheme);


            // --- Mobile Menu ---
            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });
            mobileMenu.addEventListener('click', (e) => {
                if(e.target.tagName === 'A') mobileMenu.classList.add('hidden');
            });

            // --- Header Styling on Scroll ---
            window.addEventListener('scroll', () => {
                if (window.scrollY > 10) {
                    header.style.backgroundColor = 'var(--card-light)';
                    header.style.boxShadow = '0 4px 6px -1px rgba(0, 0, 0, 0.05)';
                    if(document.documentElement.classList.contains('dark-mode')){
                        header.style.boxShadow = '0 4px 6px -1px rgba(0, 0, 0, 0.2)';
                    }
                } else {
                    header.style.backgroundColor = 'transparent';
                    header.style.boxShadow = 'none';
                }
            });
            
            // --- Active Nav Link on Scroll ---
            const observerOptions = {
                root: null,
                rootMargin: '0px',
                threshold: 0.5
            };

            const sectionObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        navLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href').substring(1) === entry.target.id) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, observerOptions);

            sections.forEach(section => {
                 // The home section is full screen, so we need a lower threshold
                if (section.id === 'home') {
                     new IntersectionObserver((entries) => {
                        if (entries[0].isIntersecting) {
                             navLinks.forEach(link => {
                                link.classList.remove('active');
                             });
                        }
                    }, { threshold: 0.8 }).observe(section);
                } else {
                    sectionObserver.observe(section);
                }
            });


            // --- Section Animations on Scroll ---
            const animatedSections = document.querySelectorAll('.animated-section');
            const animationObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            }, { threshold: 0.1 });
            animatedSections.forEach(section => animationObserver.observe(section));


            // --- Game Logic ---
            const playGameBtn = document.getElementById('play-game-btn');
            const closeGameBtn = document.getElementById('close-game-btn');
            const gameOverlay = document.getElementById('game-overlay');
            const gameControlsModal = document.getElementById('game-controls-modal');
            const startGameBtn = document.getElementById('start-game-btn');
            const canvas = document.getElementById('game-canvas');
            const ctx = canvas.getContext('2d');
            const scoreEl = document.getElementById('game-score');
            const gameMessageEl = document.getElementById('game-message');
            const gameOverTextEl = document.getElementById('game-over-text');
            const finalScoreTextEl = document.getElementById('final-score-text');
            
            let gameLoopId;
            let score = 0;
            let player;
            let bullets = [];
            let asteroids = [];
            let particles = [];
            let stars = [];
            let keys = {};
            let isGameOver = false;

            // Audio Synthesis with Tone.js
            let shootSynth, explosionSynth, playerExplosionSynth, thrustOsc;
            let audioReady = false;

            const setupAudio = () => {
                shootSynth = new Tone.Synth({
                    oscillator: { type: 'triangle' },
                    envelope: { attack: 0.01, decay: 0.1, sustain: 0.05, release: 0.2 }
                }).toDestination();

                explosionSynth = new Tone.NoiseSynth({
                    noise: { type: 'white' },
                    envelope: { attack: 0.01, decay: 0.2, sustain: 0, release: 0.1 }
                }).toDestination();

                playerExplosionSynth = new Tone.MembraneSynth({
                    pitchDecay: 0.05,
                    octaves: 10,
                    envelope: { attack: 0.001, decay: 0.4, sustain: 0.01, release: 1.4, attackCurve: 'exponential' }
                }).toDestination();

                thrustOsc = new Tone.Oscillator({
                    type: "sawtooth",
                    frequency: 50,
                    volume: -25
                }).toDestination();
                audioReady = true;
            };

            const initGame = () => {
                canvas.width = window.innerWidth * 0.9;
                canvas.height = window.innerHeight * 0.9;
                
                player = {
                    x: canvas.width / 2,
                    y: canvas.height / 2,
                    radius: 15,
                    angle: 90 / 180 * Math.PI, // Pointing up
                    rotation: 0,
                    speed: 0,
                    friction: 0.99,
                    thrust: 0.1,
                    isThrusting: false,
                    lives: 3,
                };

                score = 0;
                scoreEl.textContent = `SCORE: ${score}`;
                bullets = [];
                asteroids = [];
                particles = [];
                stars = [];

                for(let i = 0; i < 100; i++) {
                    stars.push({
                        x: Math.random() * canvas.width,
                        y: Math.random() * canvas.height,
                        radius: Math.random() * 1.5,
                        alpha: Math.random() * 0.5 + 0.2
                    });
                }

                for (let i = 0; i < 5; i++) {
                    createAsteroid();
                }
                isGameOver = false;
                gameMessageEl.classList.add('hidden');
            };

            const createExplosion = (x, y, color) => {
                for(let i = 0; i < 15; i++) {
                    particles.push({
                        x: x,
                        y: y,
                        speedX: (Math.random() - 0.5) * 4,
                        speedY: (Math.random() - 0.5) * 4,
                        radius: Math.random() * 2 + 1,
                        color: color,
                        life: 100
                    });
                }
            };
            
            const createAsteroid = (x, y, radius) => {
                const rad = radius || Math.random() * 30 + 30;
                const posX = x || (Math.random() < 0.5 ? Math.random() * canvas.width * 0.3 : canvas.width * 0.7 + Math.random() * canvas.width * 0.3);
                const posY = y || (Math.random() < 0.5 ? Math.random() * canvas.height * 0.3 : canvas.height * 0.7 + Math.random() * canvas.height * 0.3);
                
                asteroids.push({
                    x: posX,
                    y: posY,
                    radius: rad,
                    angle: Math.random() * Math.PI * 2,
                    speed: Math.random() * 1 + 0.5,
                    vertices: Math.floor(Math.random() * 5 + 7),
                    offsets: []
                });
                for(let i = 0; i < asteroids[asteroids.length -1].vertices; i++){
                    asteroids[asteroids.length -1].offsets.push(Math.random() * rad * 0.6 - rad * 0.3);
                }
            };
            
            const gameLoop = () => {
                if(isGameOver) return;
                
                // Drawing background and stars
                ctx.fillStyle = "#000";
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                stars.forEach(star => {
                    ctx.beginPath();
                    ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(255, 255, 255, ${star.alpha})`;
                    ctx.fill();
                });

                // Player movement
                player.x += player.speed * Math.cos(player.angle);
                player.y -= player.speed * Math.sin(player.angle);
                player.angle += player.rotation;
                player.speed *= player.friction;

                if (player.isThrusting) {
                    player.speed += player.thrust;
                    if(player.speed > 5) player.speed = 5;
                }

                // Wrap around screen
                if (player.x < 0 - player.radius) player.x = canvas.width + player.radius;
                if (player.x > canvas.width + player.radius) player.x = 0 - player.radius;
                if (player.y < 0 - player.radius) player.y = canvas.height + player.radius;
                if (player.y > canvas.height + player.radius) player.y = 0 - player.radius;

                // Draw thrust
                if (player.isThrusting) {
                    const grad = ctx.createLinearGradient(player.x, player.y, player.x - 20 * Math.cos(player.angle), player.y + 20 * Math.sin(player.angle));
                    grad.addColorStop(0, "orange");
                    grad.addColorStop(1, "yellow");
                    ctx.fillStyle = grad;
                    ctx.beginPath();
                    ctx.moveTo(
                        player.x - player.radius * (2 / 3 * Math.cos(player.angle) + 0.5 * Math.sin(player.angle)),
                        player.y + player.radius * (2 / 3 * Math.sin(player.angle) - 0.5 * Math.cos(player.angle))
                    );
                    ctx.lineTo(
                        player.x - player.radius * (2 / 3 * Math.cos(player.angle) - 0.5 * Math.sin(player.angle)),
                        player.y + player.radius * (2 / 3 * Math.sin(player.angle) + 0.5 * Math.cos(player.angle))
                    );
                    ctx.lineTo(
                        player.x - player.radius * 1.5 * Math.cos(player.angle),
                        player.y + player.radius * 1.5 * Math.sin(player.angle)
                    );
                    ctx.closePath();
                    ctx.fill();
                }

                // Draw player
                ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--primary-dark');
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo( // Nose of the ship
                    player.x + player.radius * Math.cos(player.angle),
                    player.y - player.radius * Math.sin(player.angle)
                );
                ctx.lineTo( // Rear left
                    player.x - player.radius * (Math.cos(player.angle) + Math.sin(player.angle)),
                    player.y + player.radius * (Math.sin(player.angle) - Math.cos(player.angle))
                );
                 ctx.lineTo( // Rear right
                    player.x - player.radius * (Math.cos(player.angle) - Math.sin(player.angle)),
                    player.y + player.radius * (Math.sin(player.angle) + Math.cos(player.angle))
                );
                ctx.closePath();
                ctx.stroke();

                // Particles
                particles.forEach((p, index) => {
                    p.x += p.speedX;
                    p.y += p.speedY;
                    p.life--;
                    if(p.life <= 0) particles.splice(index, 1);
                    else {
                        ctx.fillStyle = `rgba(${p.color}, ${p.life / 100})`;
                        ctx.beginPath();
                        ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
                        ctx.fill();
                    }
                });

                // Bullets
                bullets.forEach((bullet, index) => {
                    bullet.x += bullet.speedX;
                    bullet.y += bullet.speedY;
                    ctx.fillStyle = "#FFFF00";
                    ctx.beginPath();
                    ctx.arc(bullet.x, bullet.y, 3, 0, Math.PI * 2);
                    ctx.fill();
                    // Remove if off-screen
                    if (bullet.x < 0 || bullet.x > canvas.width || bullet.y < 0 || bullet.y > canvas.height) {
                        bullets.splice(index, 1);
                    }
                });

                // Asteroids
                asteroids.forEach((asteroid, aIndex) => {
                    asteroid.x += asteroid.speed * Math.cos(asteroid.angle);
                    asteroid.y += asteroid.speed * Math.sin(asteroid.angle);

                    // Wrap around
                    if (asteroid.x < 0 - asteroid.radius) asteroid.x = canvas.width + asteroid.radius;
                    if (asteroid.x > canvas.width + asteroid.radius) asteroid.x = 0 - asteroid.radius;
                    if (asteroid.y < 0 - asteroid.radius) asteroid.y = canvas.height + asteroid.radius;
                    if (asteroid.y > canvas.height + asteroid.radius) asteroid.y = 0 - asteroid.radius;
                    
                    ctx.strokeStyle = "#BDBDBD";
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.moveTo(
                        asteroid.x + (asteroid.radius + asteroid.offsets[0]) * Math.cos(0),
                        asteroid.y + (asteroid.radius + asteroid.offsets[0]) * Math.sin(0)
                    );
                    for(let j = 1; j < asteroid.vertices; j++){
                        ctx.lineTo(
                           asteroid.x + (asteroid.radius + asteroid.offsets[j]) * Math.cos(j * Math.PI * 2 / asteroid.vertices),
                           asteroid.y + (asteroid.radius + asteroid.offsets[j]) * Math.sin(j * Math.PI * 2 / asteroid.vertices)
                        );
                    }
                    ctx.closePath();
                    ctx.stroke();

                    // Collision: bullets and asteroids
                    bullets.forEach((bullet, bIndex) => {
                        const dist = Math.hypot(bullet.x - asteroid.x, bullet.y - asteroid.y);
                        if (dist < asteroid.radius) {
                            if (asteroid.radius > 20) {
                                score += 20;
                                createAsteroid(asteroid.x, asteroid.y, asteroid.radius / 2);
                                createAsteroid(asteroid.x, asteroid.y, asteroid.radius / 2);
                            } else {
                                score += 50;
                            }
                            if (audioReady) explosionSynth.triggerAttackRelease("4n");
                            createExplosion(asteroid.x, asteroid.y, "189, 189, 189"); // Gray
                            asteroids.splice(aIndex, 1);
                            bullets.splice(bIndex, 1);
                            scoreEl.textContent = `SCORE: ${score}`;
                        }
                    });
                    
                    // Collision: player and asteroids
                    const playerDist = Math.hypot(player.x - asteroid.x, player.y - asteroid.y);
                    if(playerDist < player.radius + asteroid.radius){
                        createExplosion(player.x, player.y, "129, 140, 248"); // Primary color
                        if (audioReady) playerExplosionSynth.triggerAttackRelease("C2", "1n");
                        endGame();
                    }
                });

                if(asteroids.length === 0){
                    for (let i = 0; i < 5; i++) {
                       createAsteroid();
                    }
                }

                gameLoopId = requestAnimationFrame(gameLoop);
            };
            
            const endGame = () => {
                isGameOver = true;
                if(audioReady && thrustOsc.state === 'started') thrustOsc.stop();
                cancelAnimationFrame(gameLoopId);
                finalScoreTextEl.textContent = `FINAL SCORE: ${score}`;
                gameMessageEl.classList.remove('hidden');
            };

            const startGame = () => {
                initGame();
                gameLoopId = requestAnimationFrame(gameLoop);
            };
            
            const handleKeyDown = (e) => {
                if(isGameOver && (e.key === 'r' || e.key === 'R')) {
                    startGame();
                    return;
                }
                
                keys[e.key] = true;
                if (keys['ArrowUp']) {
                    player.isThrusting = true;
                    if (audioReady && thrustOsc.state !== 'started') thrustOsc.start();
                }
                if (keys['ArrowLeft']) player.rotation = 0.05;
                if (keys['ArrowRight']) player.rotation = -0.05;
                if (keys[' ']) { // Spacebar
                    e.preventDefault();
                    if(bullets.length < 5) {
                        bullets.push({
                            x: player.x + player.radius * Math.cos(player.angle),
                            y: player.y - player.radius * Math.sin(player.angle),
                            speedX: 10 * Math.cos(player.angle),
                            speedY: -10 * Math.sin(player.angle),
                        });
                        if (audioReady) shootSynth.triggerAttackRelease("C5", "8n");
                    }
                }
            };

            const handleKeyUp = (e) => {
                keys[e.key] = false;
                if (!keys['ArrowUp']) {
                    player.isThrusting = false;
                    if (audioReady && thrustOsc.state === 'started') thrustOsc.stop();
                }
                if (!keys['ArrowLeft'] && !keys['ArrowRight']) player.rotation = 0;
            };

            const handleEscKey = (e) => {
                if(e.key === 'Escape') {
                    closeGameBtn.click();
                }
            };

            playGameBtn.addEventListener('click', () => {
                gameControlsModal.classList.remove('hidden');
                gameControlsModal.classList.add('flex');
            });

            startGameBtn.addEventListener('click', async () => {
                if (!audioReady) {
                    await Tone.start();
                    setupAudio();
                }
                gameControlsModal.classList.add('hidden');
                gameControlsModal.classList.remove('flex');
                
                gameOverlay.classList.remove('hidden');
                gameOverlay.classList.add('flex');
                document.body.style.overflow = 'hidden';
                window.addEventListener('keydown', handleKeyDown);
                window.addEventListener('keyup', handleKeyUp);
                window.addEventListener('keydown', handleEscKey);
                startGame();
            });

            closeGameBtn.addEventListener('click', () => {
                gameOverlay.classList.add('hidden');
                gameOverlay.classList.remove('flex');
                document.body.style.overflow = '';
                if(audioReady && thrustOsc.state === 'started') thrustOsc.stop();
                cancelAnimationFrame(gameLoopId);
                window.removeEventListener('keydown', handleKeyDown);
                window.removeEventListener('keyup', handleKeyUp);
                window.removeEventListener('keydown', handleEscKey);
            });

        });
    </script>
</body>

</html>

